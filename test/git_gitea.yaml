type: Test
spec:
  id: nfhmaDYSR
  name: git-gitea
  trigger:
    type: http
    httpRequest:
      method: POST
      url: http://gitbridge.aws.optimizor.app/gitea
      body: "{\n  \"ref\": \"refs/heads/master\",\n  \"before\": \"0000000000000000000000000000000000000000\",\n  \"after\": \"67b56589a45103f891bdee7c0546e5d40bc02001\",\n  \"compare_url\": \"http://localhost:3000/example/example/compare/0000000000000000000000000000000000000000...67b56589a45103f891bdee7c0546e5d40bc02001\",\n  \"commits\": [\n    {\n      \"id\": \"67b56589a45103f891bdee7c0546e5d40bc02001\",\n      \"message\": \"example\\n\",\n      \"url\": \"http://localhost:3000/example/example/commit/67b56589a45103f891bdee7c0546e5d40bc02001\",\n      \"author\": {\n        \"name\": \"QT\",\n        \"email\": \"example@example.com\",\n        \"username\": \"\"\n      },\n      \"committer\": {\n        \"name\": \"example\",\n        \"email\": \"example@example.com\",\n        \"username\": \"\"\n      },\n      \"verification\": null,\n      \"timestamp\": \"2022-03-09T16:23:39+09:00\",\n      \"added\": [\n        \"example\"\n      ],\n      \"removed\": [],\n      \"modified\": []\n    }\n  ],\n  \"head_commit\": {\n    \"id\": \"67b56589a45103f891bdee7c0546e5d40bc02001\",\n    \"message\": \"example\\n\",\n    \"url\": \"http://localhost:3000/example/example/commit/67b56589a45103f891bdee7c0546e5d40bc02001\",\n    \"author\": {\n      \"name\": \"QT\",\n      \"email\": \"example@example.com\",\n      \"username\": \"\"\n    },\n    \"committer\": {\n      \"name\": \"example\",\n      \"email\": \"example@example.com\",\n      \"username\": \"\"\n    },\n    \"verification\": null,\n    \"timestamp\": \"2022-03-09T16:23:39+09:00\",\n    \"added\": [\n      \"example\"\n    ],\n    \"removed\": [],\n    \"modified\": []\n  },\n  \"repository\": {\n    \"id\": 1,\n    \"owner\": {\n      \"id\": 1,\n      \"login\": \"example\",\n      \"full_name\": \"\",\n      \"email\": \"example@example.com\",\n      \"avatar_url\": \"http://localhost:3000/avatar/23463b99b62a72f26ed677cc556c44e8\",\n      \"language\": \"\",\n      \"is_admin\": false,\n      \"last_login\": \"0001-01-01T00:00:00Z\",\n      \"created\": \"2022-03-09T16:14:22+09:00\",\n      \"restricted\": false,\n      \"active\": false,\n      \"prohibit_login\": false,\n      \"location\": \"\",\n      \"website\": \"\",\n      \"description\": \"\",\n      \"visibility\": \"public\",\n      \"followers_count\": 0,\n      \"following_count\": 0,\n      \"starred_repos_count\": 0,\n      \"username\": \"example\"\n    },\n    \"name\": \"example\",\n    \"full_name\": \"example/example\",\n    \"description\": \"\",\n    \"empty\": false,\n    \"private\": false,\n    \"fork\": false,\n    \"template\": false,\n    \"parent\": null,\n    \"mirror\": false,\n    \"size\": 89,\n    \"html_url\": \"http://localhost:3000/example/example\",\n    \"ssh_url\": \"git@localhost:example/example.git\",\n    \"clone_url\": \"http://localhost:3000/example/example.git\",\n    \"original_url\": \"\",\n    \"website\": \"\",\n    \"stars_count\": 0,\n    \"forks_count\": 0,\n    \"watchers_count\": 1,\n    \"open_issues_count\": 1,\n    \"open_pr_counter\": 0,\n    \"release_counter\": 0,\n    \"default_branch\": \"master\",\n    \"archived\": false,\n    \"created_at\": \"2022-03-09T16:14:29+09:00\",\n    \"updated_at\": \"2022-03-09T16:23:53+09:00\",\n    \"permissions\": {\n      \"admin\": true,\n      \"push\": true,\n      \"pull\": true\n    },\n    \"has_issues\": true,\n    \"internal_tracker\": {\n      \"enable_time_tracker\": true,\n      \"allow_only_contributors_to_track_time\": true,\n      \"enable_issue_dependencies\": true\n    },\n    \"has_wiki\": true,\n    \"has_pull_requests\": true,\n    \"has_projects\": true,\n    \"ignore_whitespace_conflicts\": false,\n    \"allow_merge_commits\": true,\n    \"allow_rebase\": true,\n    \"allow_rebase_explicit\": true,\n    \"allow_squash_merge\": true,\n    \"default_merge_style\": \"merge\",\n    \"avatar_url\": \"\",\n    \"internal\": false,\n    \"mirror_interval\": \"\",\n    \"mirror_updated\": \"0001-01-01T00:00:00Z\",\n    \"repo_transfer\": null\n  },\n  \"pusher\": {\n    \"id\": 1,\n    \"login\": \"example\",\n    \"full_name\": \"\",\n    \"email\": \"example@example.com\",\n    \"avatar_url\": \"http://localhost:3000/avatar/23463b99b62a72f26ed677cc556c44e8\",\n    \"language\": \"\",\n    \"is_admin\": false,\n    \"last_login\": \"0001-01-01T00:00:00Z\",\n    \"created\": \"2022-03-09T16:14:22+09:00\",\n    \"restricted\": false,\n    \"active\": false,\n    \"prohibit_login\": false,\n    \"location\": \"\",\n    \"website\": \"\",\n    \"description\": \"\",\n    \"visibility\": \"public\",\n    \"followers_count\": 0,\n    \"following_count\": 0,\n    \"starred_repos_count\": 0,\n    \"username\": \"example\"\n  },\n  \"sender\": {\n    \"id\": 1,\n    \"login\": \"example\",\n    \"full_name\": \"\",\n    \"email\": \"example@example.com\",\n    \"avatar_url\": \"http://localhost:3000/avatar/23463b99b62a72f26ed677cc556c44e8\",\n    \"language\": \"\",\n    \"is_admin\": false,\n    \"last_login\": \"0001-01-01T00:00:00Z\",\n    \"created\": \"2022-03-09T16:14:22+09:00\",\n    \"restricted\": false,\n    \"active\": false,\n    \"prohibit_login\": false,\n    \"location\": \"\",\n    \"website\": \"\",\n    \"description\": \"\",\n    \"visibility\": \"public\",\n    \"followers_count\": 0,\n    \"following_count\": 0,\n    \"starred_repos_count\": 0,\n    \"username\": \"example\"\n  }\n}"
      headers:
      - key: Content-Type
        value: application/json
      - key: X-Gitea-Event
        value: push
  specs:
  - selector: span[tracetest.span.type="general" name="Tracetest trigger"]
    assertions:
    - attr:tracetest.response.status = 200
    - attr:tracetest.span.name = "Tracetest trigger"
    - attr:tracetest.span.type = "general"
  - selector: span[tracetest.span.type="http" name="/gitea" http.method="POST"]
    assertions:
    - attr:http.method = "POST"
    - attr:http.route = "/gitea"
    - attr:http.scheme = "http"
    - attr:http.status_code = 200
    - attr:net.host.name = "kubviz"
    - attr:tracetest.span.name = "/gitea"
    - attr:tracetest.span.type = "http"
