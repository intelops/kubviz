type: Test
spec:
  id: IHTebvYIR
  name: git-azure
  trigger:
    type: http
    httpRequest:
      method: POST
      url: http://gitbridge.aws.optimizor.app/azure
      body: "{\n    \"id\": \"03c164c2-8912-4d5e-8009-3707d5f83734\",\n    \"eventType\": \"git.push\",\n    \"publisherId\": \"tfs\",\n    \"scope\": \"all\",\n    \"message\": {\n      \"text\": \"Jamal Hartnett pushed updates to branch master of repository Fabrikam-Fiber-Git.\",\n      \"html\": \"Jamal Hartnett pushed updates to branch master of repository Fabrikam-Fiber-Git.\",\n      \"markdown\": \"Jamal Hartnett pushed updates to branch `master` of repository `Fabrikam-Fiber-Git`.\"\n    },\n    \"detailedMessage\": {\n      \"text\": \"Jamal Hartnett pushed 1 commit to branch master of repository Fabrikam-Fiber-Git.\\n - Fixed bug in web.config file 33b55f7c\",\n      \"html\": \"Jamal Hartnett pushed 1 commit to branch <a href=\\\"https://dev.azure.com/fabrikam-fiber-inc/DefaultCollection/_git/Fabrikam-Fiber-Git/#version=GBmaster\\\">master</a> of repository <a href=\\\"https://dev.azure.com/fabrikam-fiber-inc/DefaultCollection/_git/Fabrikam-Fiber-Git/\\\">Fabrikam-Fiber-Git</a>.\\n<ul>\\n<li>Fixed bug in web.config file <a href=\\\"https://dev.azure.com/fabrikam-fiber-inc/DefaultCollection/_git/Fabrikam-Fiber-Git/commit/33b55f7cb7e7e245323987634f960cf4a6e6bc74\\\">33b55f7c</a>\\n</ul>\",\n      \"markdown\": \"Jamal Hartnett pushed 1 commit to branch [master](https://dev.azure.com/fabrikam-fiber-inc/DefaultCollection/_git/Fabrikam-Fiber-Git/#version=GBmaster) of repository [Fabrikam-Fiber-Git](https://dev.azure.com/fabrikam-fiber-inc/DefaultCollection/_git/Fabrikam-Fiber-Git/).\\n* Fixed bug in web.config file [33b55f7c](https://dev.azure.com/fabrikam-fiber-inc/DefaultCollection/_git/Fabrikam-Fiber-Git/commit/33b55f7cb7e7e245323987634f960cf4a6e6bc74)\"\n    },\n    \"resource\": {\n      \"commits\": [\n        {\n          \"commitId\": \"33b55f7cb7e7e245323987634f960cf4a6e6bc74\",\n          \"author\": {\n            \"name\": \"QT\",\n            \"email\": \"fabrikamfiber4@hotmail.com\",\n            \"date\": \"2015-02-25T19:01:00Z\"\n          },\n          \"committer\": {\n            \"name\": \"Jamal Hartnett\",\n            \"email\": \"fabrikamfiber4@hotmail.com\",\n            \"date\": \"2015-02-25T19:01:00Z\"\n          },\n          \"comment\": \"Fixed bug in web.config file\",\n          \"url\": \"https://dev.azure.com/fabrikam-fiber-inc/DefaultCollection/_git/Fabrikam-Fiber-Git/commit/33b55f7cb7e7e245323987634f960cf4a6e6bc74\"\n        }\n      ],\n      \"refUpdates\": [\n        {\n          \"name\": \"refs/heads/main\",\n          \"oldObjectId\": \"aad331d8d3b131fa9ae03cf5e53965b51942618a\",\n          \"newObjectId\": \"33b55f7cb7e7e245323987634f960cf4a6e6bc74\"\n        }\n      ],\n      \"repository\": {\n        \"id\": \"278d5cd2-584d-4b63-824a-2ba458937249\",\n        \"name\": \"Fabrikam-Fiber-Git\",\n        \"url\": \"https://dev.azure.com/fabrikam-fiber-inc/DefaultCollection/_apis/repos/git/repositories/278d5cd2-584d-4b63-824a-2ba458937249\",\n        \"project\": {\n          \"id\": \"6ce954b1-ce1f-45d1-b94d-e6bf2464ba2c\",\n          \"name\": \"Fabrikam-Fiber-Git\",\n          \"url\": \"https://dev.azure.com/fabrikam-fiber-inc/DefaultCollection/_apis/projects/6ce954b1-ce1f-45d1-b94d-e6bf2464ba2c\",\n          \"state\": \"wellFormed\"\n        },\n        \"defaultBranch\": \"refs/heads/main\",\n        \"remoteUrl\": \"https://dev.azure.com/fabrikam-fiber-inc/DefaultCollection/_git/Fabrikam-Fiber-Git\"\n      },\n      \"pushedBy\": {\n        \"id\": \"00067FFED5C7AF52@Live.com\",\n        \"displayName\": \"QT\",\n        \"uniqueName\": \"Windows Live ID\\\\fabrikamfiber4@hotmail.com\"\n      },\n      \"pushId\": 14,\n      \"date\": \"2014-05-02T19:17:13.3309587Z\",\n      \"url\": \"https://dev.azure.com/fabrikam-fiber-inc/DefaultCollection/_apis/repos/git/repositories/278d5cd2-584d-4b63-824a-2ba458937249/pushes/14\"\n    },\n    \"resourceVersion\": \"1.0\",\n    \"resourceContainers\": {\n      \"collection\": {\n        \"id\": \"c12d0eb8-e382-443b-9f9c-c52cba5014c2\"\n      },\n      \"account\": {\n        \"id\": \"f844ec47-a9db-4511-8281-8b63f4eaf94e\"\n      },\n      \"project\": {\n        \"id\": \"be9b3917-87e6-42a4-a549-2bc06a7a878f\"\n      }\n    },\n    \"createdDate\": \"2016-09-19T13:03:27.0379153Z\"\n  }"
      headers:
      - key: Content-Type
        value: application/json
  specs:
  - selector: span[tracetest.span.type="general" name="Tracetest trigger"]
    assertions:
    - attr:name = "Tracetest trigger"
    - attr:tracetest.response.status = 200
    - attr:tracetest.span.name = "Tracetest trigger"
    - attr:tracetest.span.type = "general"
  - selector: span[tracetest.span.type="http" name="/azure" http.method="POST"]
    assertions:
    - attr:http.method = "POST"
    - attr:http.route = "/azure"
    - attr:http.scheme = "http"
    - attr:net.host.name = "kubviz"
    - attr:tracetest.span.type = "http"
    - attr:name = "/azure"
    - attr:http.status_code = 200
  - selector: span[tracetest.span.type="http" name="PostAzure" http.method="POST"]
    assertions:
    - attr:name = "PostAzure"
    - attr:http.method = "POST"
    - attr:tracetest.span.name = "PostAzure"
    - attr:tracetest.span.type = "http"
